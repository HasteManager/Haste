<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>åœ¨çº¿ç©å®¶</title>
    <link rel="shortcut icon" href="img/job/DNC.png">
    <style>

        .el-table .el-table_1_column_1 > div {
            color: deeppink;
        }

        .el-table .is-leaf > div {
            color: black;
            text-align: center;
            font-size: 20px;
        }

        .el-table .cell {
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: normal;
            word-break: break-all;
            line-height: 30px;
            padding-right: 10px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
    <!-- Vue -->
    <script src="js/vue.js"></script>
    <!-- axios -->
    <script src="js/axios.min.js"></script>
    <!-- å¼•å…¥æ ·å¼ -->
    <!--<script src="js/element-ui.js"></script>-->
    <!-- å¼•å…¥ç»„ä»¶åº“ -->
    <script src="js/element-ui-zujian.js"></script>


    <!-- å¼•å…¥æ ·å¼ -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- å¼•å…¥ç»„ä»¶åº“ -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>


</head>
<body>
<h1 style="text-align: center;color: brown"> HasteæœåŠ¡å™¨-Onlineåå•</h1>

<div id="app">
    <h3 style="text-align: center;color: brown"> (ä»2020å¹´5æœˆ20æ—¥æ™š~ç°åœ¨)æ€»æ³¨å†Œç©å®¶æ•°:{{totalChars}}</h3>
    <marquee behavior="scroll" direction="" scrollamount="10" >æœ¬ç½‘é¡µ20ç§’è‡ªåŠ¨åˆ·æ–°,ä¸ä½¿ç”¨æ—¶,åŠæ—¶å…³é—­,è°¢è°¢!ğŸ¤</marquee>
    <template>
        <el-table
                :data="tableData"
                stripe
                style="width: 100%">

            <el-table-column
                    prop="charname"
                    label="è§’è‰²åå­—"
                    width="">
            </el-table-column>
            <el-table-column
                    prop="pos_zone"
                    label="æ‰€åœ¨åœ°åŒº"
                    width="">
            </el-table-column>
            <el-table-column
                    label="ä¸»èŒ/å‰¯èŒ"
                    width="">
                <template slot-scope="scope">
                   <!-- <span>{{scope.row.mjob}}/{{scope.row.sjob}} ğŸ‘‰ {{scope.row.mlvl}}/{{scope.row.slvl}}</span>-->
                    <img :src="'img/job/'+scope.row.mjob+'.png'">{{scope.row.mlvl}}ï¼š<img :src="'img/job/'+scope.row.sjob+'.png'">{{scope.row.slvl}}
                </template>
            </el-table-column>
            <el-table-column
                    prop="race"
                    label="ç§æ—"
                    width="75px">
            </el-table-column>
            <el-table-column
                    label="å›½å®¶"
                    width="120px">
                <template slot-scope="scope" style="display: flex; justify-content: center ; align-items: center ">
                    <img v-if="scope.row.nation == 'Sandâ€˜Oria'" src="img/45px-San_d'Oria_Flag.jpg">
                    <img v-if="scope.row.nation == 'Bastok'" src="img/45px-Bastok-Flag.jpg">
                    <img v-if="scope.row.nation == 'Windurst'" src="img/45px-Windurst-Flag.jpg">
                </template>
            </el-table-column>
            <el-table-column
                    label="é˜Ÿä¼å·"
                    width="200px">
                <template slot-scope="scope">
                    <span v-if="scope.row.partyid != 'æœªç»„é˜Ÿ'"> <span
                            style="color: forestgreen"><b>{{scope.row.partyid}}</b></span> </span>
                    <span v-if="scope.row.partyid == 'æœªç»„é˜Ÿ'" style="width: 120px">
                         <marquee behavior="scroll" direction="" scrollamount="7" ><span style="color: red">å°šæœªç»„é˜Ÿ!</span></marquee>
                    </span>
                </template>
            </el-table-column>


            <el-table-column label="æ“ä½œ">
                <template slot-scope="scope">
                    <el-button
                            size="mini"
                            @click="handleEdit(scope.$index, scope.row)">ç¼–è¾‘
                    </el-button>
                    <el-button
                            size="mini"
                            type="danger"
                            @click="handleDelete(scope.$index, scope.row)">åˆ é™¤
                    </el-button>
                </template>
            </el-table-column>
        </el-table>
    </template>

    <!--åˆ†é¡µæ¡-->
    <div class="Pagination" style="text-align: center">
        <el-pagination
                @size-change="handleSizeChange"
                @current-change="handleCurrentChange"
                :current-page="currentPage"
                :page-sizes="showtotal"
                :page-size="pageSize"
                layout="total, sizes, prev, pager, next, jumper"
                :total="totalNum">
        </el-pagination>
    </div>

</div>
<a id="ibangkf" href="http://www.ibangkf.com">åœ¨çº¿å®¢æœç³»ç»Ÿ</a>
<script>
    (function () {
        var st = document.createElement("script");
        st.src = "https://c.ibangkf.com/i/c-zlk999.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(st, s);
    })();
</script>


</body>
<script>
    var vueobj = new Vue({
        el: "#app",
        data() {
            return {
                tableData: [],  //å±•ç¤ºçš„æ•°æ®
                currentPage: 1,//é»˜è®¤æ˜¾ç¤ºç¬¬ä¸€é¡µ
                pageSize: 10,//é»˜è®¤æ¯é¡µæ˜¾ç¤º10æ¡
                totalNum: 0,//æ€»é¡µæ•°
                showtotal: [5, 10, 15, 20, 50],  //æ¯é¡µæ˜¾ç¤ºçš„æ¡æ•°
                totalChars: 0,
                dingshiqi: undefined    //å®šæ—¶å™¨ å¿…é¡»å£°æ˜ï¼Œä¸ç„¶ ä½ è°ƒç”¨this.XXçš„æ—¶å€™,ä¼šæ˜¾ç¤ºXX is undefined
            }
        },
        methods: {
            handleSizeChange(val) {
                this.pageSize = val;    //åŠ¨æ€æ”¹å˜
                this.Search()
            },
            handleCurrentChange(val) {
                this.currentPage = val;    //åŠ¨æ€æ”¹å˜
                this.Search()
            },
            //ç¼–è¾‘æŒ‰é’®
            handleEdit(A, B) {
                this.open2("æš‚æ—¶æœªå¼€å‘");
            },
            //åˆ é™¤æŒ‰é’®
            handleDelete(A, B) {
                this.open2("ä¸è¦çæŒ‰");
            },
            open1(Message) {
                this.$notify({
                    title: 'æˆåŠŸ',
                    message: Message,
                    type: 'success'
                });
            },

            open2(Message) {
                this.$notify({
                    title: 'è­¦å‘Š',
                    message: Message,
                    type: 'warning'
                });
            },

            open3(Message) {
                this.$notify.info({
                    title: 'æ¶ˆæ¯',
                    message: Message
                });
            },

            open4() {
                this.$notify.error({
                    title: 'é”™è¯¯',
                    message: 'è¿™æ˜¯ä¸€æ¡é”™è¯¯çš„æç¤ºæ¶ˆæ¯'
                });
            },
            Search() {
                var self = this;
                axios({
                    url: '/player/getOnline',
                    method: 'get',
                    params: {pageNum: self.currentPage, pageSize: self.pageSize},
                    headers: {
                        /*'Content-Type': 'application/x-www-form-urlencoded'*/
                        'Content-Type': 'application/json'
                    },
                }).then(function (res) {
                    self.tableData = res.data.data;
                    self.totalNum = res.data.total;
                }).catch(function (error) {
                    console.log(error);
                })
            }, CountChar() {
                var self = this;
                axios({
                    url: '/player/CountChars',
                    method: 'get',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                }).then(function (res) {
                    self.totalChars = res.data;
                }).catch(function (error) {
                    console.log(error);
                })
            }
        },
        mounted: function () {
            var _self = this;
            this.Search();
            this.CountChar();
            /* å®šæ—¶å™¨ */
            this.dingshiqi = setInterval(function () {
                //æ‰§è¡Œå†…å®¹
                vueobj.Search();
            }, 20000);
        },
        //é”€æ¯å‰æ¸…é™¤å®šæ—¶å™¨
        beforeDestroy() {
            clearInterval(this.timer);
        }
    })

</script>
</html>